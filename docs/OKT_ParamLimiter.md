# OKT_ParamLimiter

標準パラメータ(0〜7)の最終値に上下限とリミットブレイク用の上限を設定し、
装備の `<LimitBreak>` タグで上限突破させる能力値を指定できる RPGツクールMZ 用プラグインです。

## 対応環境

- RPGツクールMZ

---

## 機能概要

- 各標準パラメータ（最大HP / 最大MP / 攻撃力 / 防御力 / 魔法力 / 魔法防御 / 敏捷性 / 運）に対して  
  プラグインパラメータで **`min / max / breakMin / breakMax`** を設定できます。
- 最終結果（装備・職業・ステート・他プラグイン補正をすべて含めた値）に対して、
  これらの値でクリップ（範囲制限）を行います。
- 武器・防具のメモ欄に書いた `<LimitBreak>` タグで、
  「どのパラメータだけ breakMin / breakMax（リミットブレイク枠）を使うか」を指定できます。
- LimitBreak の判定は **装備のみ** を対象とします（ステートのメモ欄に書いても判定には使いません）。

---

## 導入方法

1. このリポジトリから `plugins/OKT_ParamLimiter.js` をダウンロードします。
2. プロジェクトの `js/plugins` フォルダにコピーします。
3. プラグインマネージャーで **OKT_ParamLimiter** を有効にします。
4. プラグインパラメータ「標準パラメータ設定」で、各パラメータの
   `min / max / breakMin / breakMax` を必要に応じて調整してください。

---

## プラグインパラメータの書き方

各パラメータごとに、次の4つを設定できます。

- `min`      … 通常時の下限
- `max`      … 通常時の上限
- `breakMin` … LimitBreak有効時の下限
- `breakMax` … LimitBreak有効時の上限

### 設定できる値

`min / max / breakMin / breakMax` には次のいずれかを書けます：

1. **数値**  
   - 例：`0` / `9999`
2. **変数参照**  
   - `V[10]` … 変数10番の値  
   - `Var10` … 同上
3. **ParamX（AddParam 連携）**  
   - `Param0`〜`Param7` … 標準パラメータ（元の param 計算結果）  
   - `Param8` 以降 … `battler.customParam(x)` が定義されていれば、その拡張パラメータを参照  
   - 自分自身と同じ ParamID を指定した場合は無限ループ防止のため無効扱いになります。

---

## LimitBreak タグの仕様（装備限定）

武器・防具のメモ欄に次のように記述します。

```text
<LimitBreak>
<LimitBreak[2]>
<LimitBreak[0,2,4]>
```

- `<LimitBreak>`  
  - 全パラメータで LimitBreak 有効（すべて breakMin / breakMax の範囲でクリップ）
- `<LimitBreak[2]>`  
  - ParamID 2（攻撃力）のみ LimitBreak 有効
- `<LimitBreak[0,2,4]>`  
  - ParamID 0, 2, 4 だけ LimitBreak 有効

LimitBreak は「その装備を身に着けているかどうか」で判定します。  
ステートに `<LimitBreak>` を書いても、このプラグインの LimitBreak 判定には使われません  
（ステートの補正値自体は最終値の計算に含まれます）。

### 簡単な例

- 攻撃力設定：`min = 0`, `max = 999`, `breakMin = 0`, `breakMax = 9999`
- アクター素の攻撃力：`900`

| 装備状況                    | 計算 | 結果 |
|---------------------------|------|------|
| 武器A: 攻撃+500（タグなし） | 900 + 500 = 1400 → 通常枠 [0, 999] | **999** |
| 武器B: 攻撃+500 `<LimitBreak[2]>` | 900 + 500 = 1400 → ParamID2 は Break枠 [0, 9999] | **1400** |

---

## 最大HPについて

最大HP（paramId = 0）だけは「開幕即ゲームオーバー」を避けるためセーフティを入れています。

- `min / breakMin` が 1 未満または無効な値 → 自動的に **1** に補正
- `max / breakMax` が 1 未満または無効な値 → **上限なし（Infinity）** として扱う

これにより、上限を変数で指定したときに変数値が 0 でも  
「HP0スタートで即ゲームオーバー」になる状況を防ぎます。

---

## 注意事項・既知の制限

- 対象は標準パラメータ（0〜7）のみです。  
- 他プラグインで `Game_BattlerBase.prototype.param` を大きく書き換えている場合、  
  競合する可能性があります。

---

## ライセンス

- 商用・非商用利用可  
- 年齢制限作品での利用可  
- クレジット表記任意（例：`OKT_ParamLimiter / OKITA`）  
- プラグイン自体の再配布、および改変版の再配布は禁止
